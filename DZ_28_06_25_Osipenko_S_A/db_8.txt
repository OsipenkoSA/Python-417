Таблица Salespeople:
snum - номер продавца (первичный ключ)
sname - имя продавца
com - комиссионные продавца
city - город проживания продавца

Таблица Orders:
onum - номер заказа (первичный ключ)
snum - номер продавца
cnum - номер заказчика
amt - сумма заказа
odate - дата заказа

Таблица Customers:
cnum - номер заказчика (первичный ключ)
cname – имя заказчика (клиента)
city - город проживания заказчика
snum - номер продавца
rating - рейтинг



1.	Выведите перечень сумм заказов продавца Rifkin.

SELECT o.amt
FROM Orders o, Salespeople s
WHERE o.snum = s.snum AND s.sname = "Rifkin"

с использованием однострочного подзапроса:

SELECT amt
FROM Orders
WHERE snum = 
    (SELECT snum
    FROM Salespeople
    WHERE sname = "Rifkin")


2.	Определите  комиссионные всех продавцов, обслуживающих заказчиков в Риме

SELECT s.com
FROM Salespeople s, Customers c
WHERE c.snum = s.snum AND c.city = "Rome"

с использованием многострочного подзапроса:

SELECT com
FROM Salespeople
WHERE snum IN
    (SELECT snum
    FROM Customers
    WHERE city = "Rome")



3.	Напишите запрос, который определит заказчиков имеющих рейтинг ниже среднего.

SELECT cname, rating
FROM Customers
WHERE rating <
    (SELECT AVG(rating)
    FROM Customers)


4.	Определите города проживания заказчиков с наименьшим рейтингом.

SELECT city, MIN(rating)
FROM Customers
GROUP BY city
HAVING MIN(rating) = 
    (SELECT MIN(rating)
    FROM Customers)


5.	Напишите запрос, который выводил бы заказы клиента Liu

SELECT *
FROM Orders
WHERE cnum = 
            (SELECT cnum
            FROM Customers
            WHERE cname = "Liu")


6.	Определите наибольшие комиссионные продавца для Рима.

SELECT MAX(com)
FROM Salespeople
WHERE snum IN
            (SELECT snum
            FROM Customers
            WHERE city = "Rome")


7.	Напишите запрос который выведет всех клиентов обслуживаемых продавцом Motiка.

SELECT *
FROM Customers
WHERE snum IN 
            (SELECT snum
            FROM Salespeople
            WHERE sname = "Motika")


8.	Напишите запрос, который выведет максимальный рейтинг заказчика для продавцов имеющих комиссионные больше 0,11%.

SELECT MAX(rating)
FROM Customers
WHERE snum IN 
            (SELECT snum
            FROM Salespeople
            WHERE com > 0.11)



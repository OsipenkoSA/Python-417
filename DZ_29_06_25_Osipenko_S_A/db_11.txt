Таблица Prodaves:
ID_Pr - уникальный номер продовца (первичный ключ)
Name_Pr - имя продавца
City_Pr - город в котором проживает продавец
Procent - комисcионные

Таблица Klient:
ID_KL - уникальный номер клиента (первичный ключ)
ID_Pr - уникальный номер продавца
Name_KL - имя клиента
City_KL – город, в котором живет клиент
Obl_KL – страна, в которой проживает клиент
Discoun - скидки

Таблица Zakaz:
ID_Z - уникальный номер заказа (первичный ключ)
ID_Pr – уникальный номер продавца
ID_KL - уникальный номер клиента
SUMMA - сумма заказа
Kol – количество единиц товара
DATA - дата заказа
CITY_Z – город, в который доставляется заказ
Cena_Dostavki - цена доставки заказа


1.	С помощью объединения вывести данные о каждом заказчике, для которого определен продавец.

SELECT *
FROM Klient k INNER JOIN Prodaves p ON (k.ID_Pr = p.ID_Pr)
WHERE k.ID_Pr = p.ID_Pr

как на картинке:

SELECT *
FROM Zakaz


2.	Вывести имя заказчика и данные о средней цене доставки для него. Если цена доставки больше средней по таблице написать - lot, меньше – few


SELECT k.Name_KL "имя заказчика", AVG(z.Cena_Dostavki) "средняя цена доставки", "lot" "few-lot"
FROM Klient k JOIN Zakaz z ON k.ID_KL = z.ID_KL
GROUP BY k.ID_KL, k.Name_KL
HAVING AVG(z.Cena_Dostavki) < (SELECT AVG(Cena_Dostavki)
                                FROM Zakaz)

UNION 

SELECT k.Name_KL "имя заказчика", AVG(z.Cena_Dostavki) "средняя цена доставки", "few" "few-lot"
FROM Klient k JOIN Zakaz z ON k.ID_KL = z.ID_KL
GROUP BY k.ID_KL, k.Name_KL
HAVING AVG(z.Cena_Dostavki) > (SELECT AVG(Cena_Dostavki)
                                FROM Zakaz);


3.	Соедините вместе все таблицы с помощью внешнего объединения.


SELECT *
FROM Zakaz z RIGHT JOIN Klient k ON (z.ID_KL = k.ID_KL) RIGHT JOIN Prodaves p ON (k.ID_Pr = p.ID_Pr)


4.	С помощью объединения вывести данные о скидках клиента для каждого продавца


SELECT k.Name_KL, k.Discoun, p.Name_Pr
FROM Klient k JOIN Prodaves p ON (k.ID_Pr = p.ID_Pr)


5.	Напишите запрос, который выведет все города, в которых живут продавцы и заказчики.


SELECT City_KL город
FROM Klient

UNION ALL

SELECT City_Pr город
FROM Prodaves


6.	С помощью объединения вывести все данные о заказчиках и  заказах, даже если заказчик не сделал ни одного заказа за указанный период.

SELECT *
FROM Klient k JOIN Zakaz z ON (k.ID_KL = z.ID_KL)


7.	Составьте запроса для вывода имен и кодов всех продавцов, в чьих городах есть покупатели, которых они не обслуживают. С помощью оператора в подзапросе.

SELECT p.Name_Pr, p.ID_Pr 
FROM Prodaves p
WHERE p.City_Pr IN (
                    SELECT k.City_KL 
                    FROM Klient k
                    WHERE k.City_KL = p.City_Pr AND k.ID_Pr != p.ID_Pr)



8.	Напишите запрос, который выведет все города и имена продавцов и заказчиков, которые живут в Лондоне.

SELECT Name_Pr Имя, City_Pr Город
FROM Prodaves 
WHERE City_Pr = "London"

UNION ALL

SELECT Name_KL Имя, City_KL Город
FROM Klient 
WHERE City_KL = "London"